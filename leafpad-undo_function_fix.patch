diff -ruN leafpad-0.7.7/src/undo.c leafpad-0.7.7.1/src/undo.c
--- leafpad-0.7.7/src/undo.c	2004-11-19 07:04:27.000000000 +0900
+++ leafpad-0.7.7.1/src/undo.c	2004-11-21 20:01:04.000000000 +0900
@@ -159,7 +159,8 @@
 		ui_tmp->command = command;
 		ui_tmp->start = start;
 		ui_tmp->end = end;
-		g_string_printf(undo_gstr, str);
+		undo_gstr = g_string_erase(undo_gstr, 0, -1);
+		g_string_append(undo_gstr, str);
 	} else 
 		undo_append_undo_info(buffer, command, start, end, g_strdup(str));
 	
